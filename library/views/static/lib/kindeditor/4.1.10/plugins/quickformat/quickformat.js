KindEditor.plugin("quickformat",function(K){function getFirstChild(knode){for(var child=knode.first();child&&child.first();)child=child.first();return child}var self=this,name="quickformat",blockMap=K.toMap("blockquote,center,div,h1,h2,h3,h4,h5,h6,p");self.clickToolbar(name,function(){self.focus();for(var next,doc=self.edit.doc,range=self.cmd.range,child=K(doc.body).first(),nodeList=[],subList=[],bookmark=range.createBookmark(!0);child;){next=child.next();var firstChild=getFirstChild(child);firstChild&&"img"==firstChild.name||(blockMap[child.name]?(child.html(child.html().replace(/^(\s|&nbsp;|ã€€)+/gi,"")),child.css("text-indent","2em")):subList.push(child),(!next||blockMap[next.name]||blockMap[child.name]&&!blockMap[next.name])&&(subList.length>0&&nodeList.push(subList),subList=[])),child=next}K.each(nodeList,function(i,subList){var wrapper=K('<p style="text-indent:2em;"></p>',doc);subList[0].before(wrapper),K.each(subList,function(i,knode){wrapper.append(knode)})}),range.moveToBookmark(bookmark),self.addBookmark()})});